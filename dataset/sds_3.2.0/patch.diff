diff --git a/coffee/set.coffee b/coffee/set.coffee
index aa6fe3e..382d23c 100644
--- a/coffee/set.coffee
+++ b/coffee/set.coffee
@@ -15,8 +15,12 @@ set = (object, keypath, value) ->
     throw "invalid keypath: #{JSON.stringify keypath}" if not (keypath instanceof Array)
     
     kp = [].concat keypath
-    o = object
     
+    if '__proto__' in keypath # let's try to make those security bots happy ...
+        throw "__proto__ in keypath: #{JSON.stringify keypath}"
+    
+    o = object
+        
     while kp.length > 1
         k = kp.shift()
         if not o[k]?
diff --git a/js/set.js b/js/set.js
index bafdc6f..4b0f442 100644
--- a/js/set.js
+++ b/js/set.js
@@ -1,4 +1,4 @@
-// koffee 0.56.0
+// koffee 1.14.0
 
 /*
  0000000  00000000  000000000
@@ -7,7 +7,8 @@
      000  000          000   
 0000000   00000000     000
  */
-var set;
+var set,
+    indexOf = [].indexOf;
 
 set = function(object, keypath, value) {
     var k, kp, o;
@@ -18,6 +19,9 @@ set = function(object, keypath, value) {
         throw "invalid keypath: " + (JSON.stringify(keypath));
     }
     kp = [].concat(keypath);
+    if (indexOf.call(keypath, '__proto__') >= 0) {
+        throw "__proto__ in keypath: " + (JSON.stringify(keypath));
+    }
     o = object;
     while (kp.length > 1) {
         k = kp.shift();
@@ -46,5 +50,5 @@ set = function(object, keypath, value) {
 
 module.exports = set;
 
-//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFXQSxHQUFBLEdBQU0sU0FBQyxNQUFELEVBQVMsT0FBVCxFQUFrQixLQUFsQjtBQUVGLFFBQUE7SUFBQSxJQUErQixPQUFPLE9BQVAsS0FBbUIsUUFBbEQ7UUFBQSxPQUFBLEdBQVUsT0FBTyxDQUFDLEtBQVIsQ0FBYyxHQUFkLEVBQVY7O0lBQ0EsSUFBc0QsQ0FBSSxDQUFDLE9BQUEsWUFBbUIsS0FBcEIsQ0FBMUQ7QUFBQSxjQUFNLG1CQUFBLEdBQW1CLENBQUMsSUFBSSxDQUFDLFNBQUwsQ0FBZSxPQUFmLENBQUQsRUFBekI7O0lBRUEsRUFBQSxHQUFLLEVBQUUsQ0FBQyxNQUFILENBQVUsT0FBVjtJQUNMLENBQUEsR0FBSTtBQUVKLFdBQU0sRUFBRSxDQUFDLE1BQUgsR0FBWSxDQUFsQjtRQUNJLENBQUEsR0FBSSxFQUFFLENBQUMsS0FBSCxDQUFBO1FBQ0osSUFBTyxZQUFQO1lBQ0ksSUFBRyxDQUFJLE1BQU0sQ0FBQyxLQUFQLENBQWEsUUFBQSxDQUFTLENBQVQsQ0FBYixDQUFQO2dCQUNJLENBQUEsR0FBSSxDQUFFLENBQUEsQ0FBQSxDQUFGLEdBQU8sR0FEZjthQUFBLE1BQUE7Z0JBR0ksQ0FBQSxHQUFJLENBQUUsQ0FBQSxDQUFBLENBQUYsR0FBTyxHQUhmO2FBREo7U0FBQSxNQUFBO1lBTUksQ0FBQSxHQUFJLENBQUUsQ0FBQSxDQUFBLEVBTlY7O0lBRko7SUFVQSxJQUFHLEVBQUUsQ0FBQyxNQUFILEtBQWEsQ0FBYixJQUFtQixXQUF0QjtRQUNJLElBQUcsS0FBQSxLQUFTLE1BQVo7WUFDSSxPQUFPLENBQUUsQ0FBQSxFQUFHLENBQUEsQ0FBQSxDQUFILEVBRGI7U0FBQSxNQUFBO1lBR0ksQ0FBRSxDQUFBLEVBQUcsQ0FBQSxDQUFBLENBQUgsQ0FBRixHQUFXO1lBQ1gsSUFBRyxDQUFFLENBQUEsRUFBRyxDQUFBLENBQUEsQ0FBSCxDQUFGLEtBQVksS0FBZjtBQUNJLHNCQUFNLHFCQUFBLEdBQXFCLENBQUMsSUFBSSxDQUFDLFNBQUwsQ0FBZSxLQUFmLENBQUQsQ0FBckIsR0FBMkMsZUFBM0MsR0FBeUQsQ0FBQyxPQUFPLENBQUMsSUFBUixDQUFhLEdBQWIsQ0FBRCxDQUF6RCxHQUEyRSxNQUEzRSxHQUFnRixDQUFDLElBQUksQ0FBQyxTQUFMLENBQWUsTUFBZixDQUFELEVBRDFGO2FBSko7U0FESjs7V0FPQTtBQXpCRTs7QUEyQk4sTUFBTSxDQUFDLE9BQVAsR0FBaUIiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbiAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAwXG4wMDAgICAgICAgMDAwICAgICAgICAgIDAwMCAgIFxuMDAwMDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICBcbiAgICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgXG4wMDAwMDAwICAgMDAwMDAwMDAgICAgIDAwMCAgIFxuIyMjXG5cbiMgYWNjZXB0cyBhbiBvYmplY3QsIGEga2V5cGF0aCBhcyBhbiBhcnJheSBvciBzdHJpbmcgYW5kIGEgdmFsdWVcbiMgcmV0dXJucyB0aGUgb2JqZWN0IHdpdGggdmFsdWUgc2V0IGF0IGtleXBhdGhcblxuc2V0ID0gKG9iamVjdCwga2V5cGF0aCwgdmFsdWUpIC0+XG4gICAgXG4gICAga2V5cGF0aCA9IGtleXBhdGguc3BsaXQgJy4nIGlmIHR5cGVvZihrZXlwYXRoKSA9PSAnc3RyaW5nJ1xuICAgIHRocm93IFwiaW52YWxpZCBrZXlwYXRoOiAje0pTT04uc3RyaW5naWZ5IGtleXBhdGh9XCIgaWYgbm90IChrZXlwYXRoIGluc3RhbmNlb2YgQXJyYXkpXG4gICAgXG4gICAga3AgPSBbXS5jb25jYXQga2V5cGF0aFxuICAgIG8gPSBvYmplY3RcbiAgICBcbiAgICB3aGlsZSBrcC5sZW5ndGggPiAxXG4gICAgICAgIGsgPSBrcC5zaGlmdCgpXG4gICAgICAgIGlmIG5vdCBvW2tdP1xuICAgICAgICAgICAgaWYgbm90IE51bWJlci5pc05hTiBwYXJzZUludCBrXG4gICAgICAgICAgICAgICAgbyA9IG9ba10gPSBbXVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIG8gPSBvW2tdID0ge31cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgbyA9IG9ba11cbiAgICAgICAgICAgIFxuICAgIGlmIGtwLmxlbmd0aCA9PSAxIGFuZCBvP1xuICAgICAgICBpZiB2YWx1ZSA9PSB1bmRlZmluZWRcbiAgICAgICAgICAgIGRlbGV0ZSBvW2twWzBdXVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBvW2twWzBdXSA9IHZhbHVlXG4gICAgICAgICAgICBpZiBvW2twWzBdXSAhPSB2YWx1ZVxuICAgICAgICAgICAgICAgIHRocm93IFwiY291bGRuJ3Qgc2V0IHZhbHVlICN7SlNPTi5zdHJpbmdpZnkgdmFsdWV9IGZvciBrZXlwYXRoICN7a2V5cGF0aC5qb2luICcuJ30gaW4gI3tKU09OLnN0cmluZ2lmeSBvYmplY3R9XCJcbiAgICBvYmplY3RcblxubW9kdWxlLmV4cG9ydHMgPSBzZXRcbiJdfQ==
+//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2V0LmpzIiwic291cmNlUm9vdCI6Ii4uL2NvZmZlZSIsInNvdXJjZXMiOlsic2V0LmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSxHQUFBO0lBQUE7O0FBV0EsR0FBQSxHQUFNLFNBQUMsTUFBRCxFQUFTLE9BQVQsRUFBa0IsS0FBbEI7QUFFRixRQUFBO0lBQUEsSUFBK0IsT0FBTyxPQUFQLEtBQW1CLFFBQWxEO1FBQUEsT0FBQSxHQUFVLE9BQU8sQ0FBQyxLQUFSLENBQWMsR0FBZCxFQUFWOztJQUNBLElBQXNELENBQUksQ0FBQyxPQUFBLFlBQW1CLEtBQXBCLENBQTFEO0FBQUEsY0FBTSxtQkFBQSxHQUFtQixDQUFDLElBQUksQ0FBQyxTQUFMLENBQWUsT0FBZixDQUFELEVBQXpCOztJQUVBLEVBQUEsR0FBSyxFQUFFLENBQUMsTUFBSCxDQUFVLE9BQVY7SUFFTCxJQUFHLGFBQWUsT0FBZixFQUFBLFdBQUEsTUFBSDtBQUNJLGNBQU0sd0JBQUEsR0FBd0IsQ0FBQyxJQUFJLENBQUMsU0FBTCxDQUFlLE9BQWYsQ0FBRCxFQURsQzs7SUFHQSxDQUFBLEdBQUk7QUFFSixXQUFNLEVBQUUsQ0FBQyxNQUFILEdBQVksQ0FBbEI7UUFDSSxDQUFBLEdBQUksRUFBRSxDQUFDLEtBQUgsQ0FBQTtRQUNKLElBQU8sWUFBUDtZQUNJLElBQUcsQ0FBSSxNQUFNLENBQUMsS0FBUCxDQUFhLFFBQUEsQ0FBUyxDQUFULENBQWIsQ0FBUDtnQkFDSSxDQUFBLEdBQUksQ0FBRSxDQUFBLENBQUEsQ0FBRixHQUFPLEdBRGY7YUFBQSxNQUFBO2dCQUdJLENBQUEsR0FBSSxDQUFFLENBQUEsQ0FBQSxDQUFGLEdBQU8sR0FIZjthQURKO1NBQUEsTUFBQTtZQU1JLENBQUEsR0FBSSxDQUFFLENBQUEsQ0FBQSxFQU5WOztJQUZKO0lBVUEsSUFBRyxFQUFFLENBQUMsTUFBSCxLQUFhLENBQWIsSUFBbUIsV0FBdEI7UUFDSSxJQUFHLEtBQUEsS0FBUyxNQUFaO1lBQ0ksT0FBTyxDQUFFLENBQUEsRUFBRyxDQUFBLENBQUEsQ0FBSCxFQURiO1NBQUEsTUFBQTtZQUdJLENBQUUsQ0FBQSxFQUFHLENBQUEsQ0FBQSxDQUFILENBQUYsR0FBVztZQUNYLElBQUcsQ0FBRSxDQUFBLEVBQUcsQ0FBQSxDQUFBLENBQUgsQ0FBRixLQUFZLEtBQWY7QUFDSSxzQkFBTSxxQkFBQSxHQUFxQixDQUFDLElBQUksQ0FBQyxTQUFMLENBQWUsS0FBZixDQUFELENBQXJCLEdBQTJDLGVBQTNDLEdBQXlELENBQUMsT0FBTyxDQUFDLElBQVIsQ0FBYSxHQUFiLENBQUQsQ0FBekQsR0FBMkUsTUFBM0UsR0FBZ0YsQ0FBQyxJQUFJLENBQUMsU0FBTCxDQUFlLE1BQWYsQ0FBRCxFQUQxRjthQUpKO1NBREo7O1dBT0E7QUE3QkU7O0FBK0JOLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4gMDAwMDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwMFxuMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICBcbjAwMDAwMDAgICAwMDAwMDAwICAgICAgMDAwICAgXG4gICAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgIFxuMDAwMDAwMCAgIDAwMDAwMDAwICAgICAwMDAgICBcbiMjI1xuXG4jIGFjY2VwdHMgYW4gb2JqZWN0LCBhIGtleXBhdGggYXMgYW4gYXJyYXkgb3Igc3RyaW5nIGFuZCBhIHZhbHVlXG4jIHJldHVybnMgdGhlIG9iamVjdCB3aXRoIHZhbHVlIHNldCBhdCBrZXlwYXRoXG5cbnNldCA9IChvYmplY3QsIGtleXBhdGgsIHZhbHVlKSAtPlxuICAgIFxuICAgIGtleXBhdGggPSBrZXlwYXRoLnNwbGl0ICcuJyBpZiB0eXBlb2Yoa2V5cGF0aCkgPT0gJ3N0cmluZydcbiAgICB0aHJvdyBcImludmFsaWQga2V5cGF0aDogI3tKU09OLnN0cmluZ2lmeSBrZXlwYXRofVwiIGlmIG5vdCAoa2V5cGF0aCBpbnN0YW5jZW9mIEFycmF5KVxuICAgIFxuICAgIGtwID0gW10uY29uY2F0IGtleXBhdGhcbiAgICBcbiAgICBpZiAnX19wcm90b19fJyBpbiBrZXlwYXRoICMgbGV0J3MgdHJ5IHRvIG1ha2UgdGhvc2Ugc2VjdXJpdHkgYm90cyBoYXBweSAuLi5cbiAgICAgICAgdGhyb3cgXCJfX3Byb3RvX18gaW4ga2V5cGF0aDogI3tKU09OLnN0cmluZ2lmeSBrZXlwYXRofVwiXG4gICAgXG4gICAgbyA9IG9iamVjdFxuICAgICAgICBcbiAgICB3aGlsZSBrcC5sZW5ndGggPiAxXG4gICAgICAgIGsgPSBrcC5zaGlmdCgpXG4gICAgICAgIGlmIG5vdCBvW2tdP1xuICAgICAgICAgICAgaWYgbm90IE51bWJlci5pc05hTiBwYXJzZUludCBrXG4gICAgICAgICAgICAgICAgbyA9IG9ba10gPSBbXVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIG8gPSBvW2tdID0ge31cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgbyA9IG9ba11cbiAgICAgICAgICAgIFxuICAgIGlmIGtwLmxlbmd0aCA9PSAxIGFuZCBvP1xuICAgICAgICBpZiB2YWx1ZSA9PSB1bmRlZmluZWRcbiAgICAgICAgICAgIGRlbGV0ZSBvW2twWzBdXVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBvW2twWzBdXSA9IHZhbHVlXG4gICAgICAgICAgICBpZiBvW2twWzBdXSAhPSB2YWx1ZVxuICAgICAgICAgICAgICAgIHRocm93IFwiY291bGRuJ3Qgc2V0IHZhbHVlICN7SlNPTi5zdHJpbmdpZnkgdmFsdWV9IGZvciBrZXlwYXRoICN7a2V5cGF0aC5qb2luICcuJ30gaW4gI3tKU09OLnN0cmluZ2lmeSBvYmplY3R9XCJcbiAgICBvYmplY3RcblxubW9kdWxlLmV4cG9ydHMgPSBzZXRcbiJdfQ==
 //# sourceURL=../coffee/set.coffee
\ No newline at end of file
diff --git a/package.json b/package.json
index c10778b..72e46f4 100644
--- a/package.json
+++ b/package.json
@@ -1,6 +1,6 @@
 {
   "name": "sds",
-  "version": "3.3.0",
+  "version": "4.0.0",
   "description": "structured data search",
   "main": "./js/main.js",
   "author": "monsterkodi",
diff --git a/package.noon b/package.noon
index e977120..f46a5d4 100644
--- a/package.noon
+++ b/package.noon
@@ -1,5 +1,5 @@
 name            sds
-version         3.3.0
+version         4.0.0
 description     structured data search
 main            ./js/main.js
 author          monsterkodi
diff --git a/test/test.coffee b/test/test.coffee
index 8da28d2..281e8ea 100644
--- a/test/test.coffee
+++ b/test/test.coffee
@@ -219,6 +219,14 @@ describe 'set', ->
         expect sds.set {a: {c:3} }, 'a.c'
         .to.eql {a:{}}
 
+    it 'should not allow any __proto__ in keypath', ->
+
+        expect -> sds.set {}, '__proto__.jhu', true
+        .to.throw '__proto__ in keypath: ["__proto__","jhu"]'
+
+        expect -> sds.set {}, 'bla.__proto__.jhu', true
+        .to.throw '__proto__ in keypath: ["bla","__proto__","jhu"]'
+        
 ###
 00000000  000  000   000  0000000
 000       000  0000  000  000   000
