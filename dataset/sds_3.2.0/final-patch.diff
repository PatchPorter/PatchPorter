diff --git a/js/set.js b/js/set.js
index bafdc6f..4b0f442 100644
--- a/js/set.js
+++ b/js/set.js
@@ -18,6 +19,9 @@ set = function(object, keypath, value) {
         throw "invalid keypath: " + (JSON.stringify(keypath));
     }
     kp = [].concat(keypath);
+    if (indexOf.call(keypath, '__proto__') >= 0) {
+        throw "__proto__ in keypath: " + (JSON.stringify(keypath));
+    }
     o = object;
     while (kp.length > 1) {
         k = kp.shift();
diff --git a/js/set.js b/js/set.js
index bafdc6f..4b0f442 100644
--- a/js/set.js
+++ b/js/set.js
@@ -7,7 +7,8 @@
      000  000          000   
 0000000   00000000     000
  */
-var set;
+var set,
+    indexOf = [].indexOf;
 
 set = function(object, keypath, value) {
     var k, kp, o;
